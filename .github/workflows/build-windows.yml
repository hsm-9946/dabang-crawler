name: Build Windows Executable

on:
  push:
    branches: [ main, develop ]
    tags: [ 'v*' ]
  pull_request:
    branches: [ main ]
  workflow_dispatch:  # ìˆ˜ë™ ì‹¤í–‰ ê°€ëŠ¥

jobs:
  build-windows:
    runs-on: windows-latest
    
    strategy:
      matrix:
        python-version: [3.12]  # ë¹Œë“œ ì‹œê°„ ë‹¨ì¶•ì„ ìœ„í•´ 3.12ë§Œ ì‚¬ìš©
    
    env:
      # Windows í•œêµ­ì–´ í™˜ê²½ ì„¤ì •
      PYTHONIOENCODING: utf-8
      PYTHONUTF8: 1
      # Windows ì‹œìŠ¤í…œ ë¡œì¼€ì¼ ì„¤ì •
      SYSTEMROOT: C:\Windows
      WINDIR: C:\Windows
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Set up Python ${{ matrix.python-version }}
      uses: actions/setup-python@v4
      with:
        python-version: ${{ matrix.python-version }}
        
    - name: Cache pip dependencies
      uses: actions/cache@v4  # v3ì—ì„œ v4ë¡œ ì—…ë°ì´íŠ¸
      with:
        path: ~/.cache/pip
        key: ${{ runner.os }}-pip-${{ matrix.python-version }}-${{ hashFiles('**/requirements.txt') }}
        restore-keys: |
          ${{ runner.os }}-pip-${{ matrix.python-version }}-
          
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt
        playwright install chromium
        playwright install-deps chromium
        
    - name: Create build directory
      run: |
        mkdir build
        mkdir dist
        mkdir output
        mkdir logs
        
    - name: Build executables using spec file
      run: |
        pyinstaller build_config.spec --noconfirm --clean
        if ($LASTEXITCODE -ne 0) {
          Write-Host "Spec íŒŒì¼ ë¹Œë“œ ì‹¤íŒ¨, ê¸°ë³¸ ì„¤ì •ìœ¼ë¡œ ì¬ì‹œë„..."
          pyinstaller --onefile --windowed --name "ë‹¤ë°©í¬ë¡¤ëŸ¬" --icon "assets/icon.ico" --noconfirm --clean app/gui.py
          pyinstaller --onefile --name "ë‹¤ë°©í¬ë¡¤ëŸ¬_CLI" --icon "assets/icon.ico" --noconfirm --clean app/cli_collect.py
        }
        
    - name: Create package directory
      run: |
        mkdir package
        mkdir package/config
        mkdir package/data
        mkdir package/logs
        mkdir package/output
        mkdir package/scraper
        
    - name: Copy files to package
      run: |
        # ì‹¤í–‰ íŒŒì¼ ë³µì‚¬
        if (Test-Path "dist/ë‹¤ë°©í¬ë¡¤ëŸ¬.exe") { Copy-Item "dist/ë‹¤ë°©í¬ë¡¤ëŸ¬.exe" "package/" }
        if (Test-Path "dist/ë‹¤ë°©í¬ë¡¤ëŸ¬_CLI.exe") { Copy-Item "dist/ë‹¤ë°©í¬ë¡¤ëŸ¬_CLI.exe" "package/" }
        
        # ì„¤ì • íŒŒì¼ë“¤
        if (Test-Path "config/settings.toml") { Copy-Item "config/settings.toml" "package/config/" }
        if (Test-Path "data/regions_kr.json") { Copy-Item "data/regions_kr.json" "package/data/" }
        
        # ìŠ¤í¬ë˜í¼ íŒŒì¼ë“¤
        if (Test-Path "scraper/selectors.json") { Copy-Item "scraper/selectors.json" "package/scraper/" }
        if (Test-Path "scraper/selectors_direct.json") { Copy-Item "scraper/selectors_direct.json" "package/scraper/" }
        if (Test-Path "scraper/selectors_enhanced.json") { Copy-Item "scraper/selectors_enhanced.json" "package/scraper/" }
        if (Test-Path "scraper/parsers.py") { Copy-Item "scraper/parsers.py" "package/scraper/" }
        if (Test-Path "scraper/anti_bot.py") { Copy-Item "scraper/anti_bot.py" "package/scraper/" }
        if (Test-Path "scraper/region_resolver.py") { Copy-Item "scraper/region_resolver.py" "package/scraper/" }
        if (Test-Path "scraper/dabang_scraper.py") { Copy-Item "scraper/dabang_scraper.py" "package/scraper/" }
        if (Test-Path "scraper/dabang_scraper_backup.py") { Copy-Item "scraper/dabang_scraper_backup.py" "package/scraper/" }
        if (Test-Path "scraper/dabang_selenium.py") { Copy-Item "scraper/dabang_selenium.py" "package/scraper/" }
        
        # ìŠ¤í¬ë˜í¼ utils í´ë”
        if (Test-Path "scraper/utils") { 
            New-Item -ItemType Directory -Force -Path "package/scraper/utils"
            Copy-Item "scraper/utils/*" "package/scraper/utils/" -Recurse -Force
        }
        
        # ì•± íŒŒì¼ë“¤
        if (Test-Path "app") { 
            New-Item -ItemType Directory -Force -Path "package/app"
            Copy-Item "app/*" "package/app/" -Recurse -Force
        }
        
        # ìŠ¤í† ë¦¬ì§€ íŒŒì¼ë“¤
        if (Test-Path "storage") { 
            New-Item -ItemType Directory -Force -Path "package/storage"
            Copy-Item "storage/*" "package/storage/" -Recurse -Force
        }
        
        # TypeScript íŒŒì¼ë“¤
        if (Test-Path "scripts") { 
            New-Item -ItemType Directory -Force -Path "package/scripts"
            Copy-Item "scripts/*" "package/scripts/" -Recurse -Force
        }
        
        # ë„êµ¬ íŒŒì¼ë“¤
        if (Test-Path "tools") { 
            New-Item -ItemType Directory -Force -Path "package/tools"
            Copy-Item "tools/*" "package/tools/" -Recurse -Force
        }
        
        # í…ŒìŠ¤íŠ¸ íŒŒì¼ë“¤
        if (Test-Path "tests") { 
            New-Item -ItemType Directory -Force -Path "package/tests"
            Copy-Item "tests/*" "package/tests/" -Recurse -Force
        }
        
        # realestate_dabang ëª¨ë“ˆ
        if (Test-Path "realestate_dabang") { 
            New-Item -ItemType Directory -Force -Path "package/realestate_dabang"
            Copy-Item "realestate_dabang/*" "package/realestate_dabang/" -Recurse -Force
        }
        
        # ë£¨íŠ¸ íŒŒì¼ë“¤
        if (Test-Path "README.md") { Copy-Item "README.md" "package/" }
        if (Test-Path "LICENSE") { Copy-Item "LICENSE" "package/" }
        if (Test-Path "requirements.txt") { Copy-Item "requirements.txt" "package/" }
        if (Test-Path "package.json") { Copy-Item "package.json" "package/" }
        if (Test-Path "package-lock.json") { Copy-Item "package-lock.json" "package/" }
        if (Test-Path "tsconfig.json") { Copy-Item "tsconfig.json" "package/" }
        if (Test-Path "create_icon.py") { Copy-Item "create_icon.py" "package/" }
        if (Test-Path "build_advanced.bat") { Copy-Item "build_advanced.bat" "package/" }
        if (Test-Path "build_local.bat") { Copy-Item "build_local.bat" "package/" }
        if (Test-Path "installer.nsi") { Copy-Item "installer.nsi" "package/" }
        if (Test-Path "test_search.py") { Copy-Item "test_search.py" "package/" }
        if (Test-Path "test_all_types.js") { Copy-Item "test_all_types.js" "package/" }
        if (Test-Path "test_apartment.js") { Copy-Item "test_apartment.js" "package/" }
        if (Test-Path "test_pagination.js") { Copy-Item "test_pagination.js" "package/" }
        if (Test-Path "test_pagination_final.js") { Copy-Item "test_pagination_final.js" "package/" }
        if (Test-Path "test_single.js") { Copy-Item "test_single.js" "package/" }
        
        # ì•„ì´ì½˜ íŒŒì¼
        if (Test-Path "assets/icon.ico") { 
            New-Item -ItemType Directory -Force -Path "package/assets"
            Copy-Item "assets/icon.ico" "package/assets/"
        }
        
        # ë³µì‚¬ëœ íŒŒì¼ ëª©ë¡ ì¶œë ¥
        Write-Host "=== ë³µì‚¬ëœ íŒŒì¼ ëª©ë¡ ===" -ForegroundColor Green
        Get-ChildItem "package" -Recurse | ForEach-Object { Write-Host $_.FullName.Replace("$PWD\package\", "") }
        
    - name: Create batch files
      run: |
        echo '@echo off' > package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo 'chcp 65001 >nul' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo 'echo ========================================' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo 'echo    Dabang Real Estate Crawler v2.0' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo 'echo ========================================' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo 'echo.' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo 'echo Main Features:' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo 'echo - Automatic property data collection from Dabang' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo 'echo - Excel file export' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo 'echo - Improved CSS selectors for accurate data parsing' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo 'echo - Disabled duplicate removal (collect all data)' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo 'echo.' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo 'echo 1. GUI Mode (Graphical Interface)' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo 'echo 2. CLI Mode (Command Line Interface)' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo 'echo 3. Edit Settings File' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo 'echo 4. View Logs' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo 'echo 5. Open Output Folder' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo 'echo.' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo 'set /p choice="Select option (1-5): "' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo 'if "%choice%"=="1" (' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '    echo Starting GUI mode...' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '    if exist "ë‹¤ë°©í¬ë¡¤ëŸ¬.exe" (' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '        start "" "ë‹¤ë°©í¬ë¡¤ëŸ¬.exe"' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '    ) else (' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '        echo Error: ë‹¤ë°©í¬ë¡¤ëŸ¬.exe not found!' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '        echo Please check if the file exists in the current directory.' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '        pause' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '    )' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo ') else if "%choice%"=="2" (' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '    echo CLI Mode Usage:' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '    echo.' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '    echo Basic Usage:' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '    echo ë‹¤ë°©í¬ë¡¤ëŸ¬_CLI.exe --region "region_name" --type "property_type" --limit count' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '    echo.' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '    echo Examples:' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '    echo ë‹¤ë°©í¬ë¡¤ëŸ¬_CLI.exe --region "Seoul Gangnam" --type "ì›ë£¸" --limit 10' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '    echo ë‹¤ë°©í¬ë¡¤ëŸ¬_CLI.exe --region "Busan Haeundae" --type "ì•„íŒŒíŠ¸" --limit 20' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '    echo.' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '    echo Property Types: ì›ë£¸, íˆ¬ë£¸, ì•„íŒŒíŠ¸, ì£¼íƒ/ë¹Œë¼, ì˜¤í”¼ìŠ¤í…”' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '    echo.' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '    pause' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo ') else if "%choice%"=="3" (' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '    echo Opening settings file...' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '    if exist "config\settings.toml" (' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '        notepad config\settings.toml' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '    ) else (' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '        echo Error: settings.toml not found!' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '        pause' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '    )' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo ') else if "%choice%"=="4" (' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '    echo Opening logs folder...' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '    if exist "logs\*.log" (' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '        start "" logs' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '    ) else (' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '        echo No log files found.' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '        pause' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '    )' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo ') else if "%choice%"=="5" (' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '    echo Opening output folder...' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '    if exist "output\*.xlsx" (' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '        start "" output' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '    ) else (' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '        echo No output files found.' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '        pause' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '    )' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo ') else (' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '    echo Invalid selection.' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo '    pause' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        echo ')' >> package/ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat
        
    - name: Create README for package
      run: |
        echo "# ë‹¤ë°© ë¶€ë™ì‚° í¬ë¡¤ëŸ¬ Windows íŒ¨í‚¤ì§€ v2.0" > package/README_Windows.txt
        echo "" >> package/README_Windows.txt
        echo "## ğŸš€ ìƒˆë¡œìš´ ê¸°ëŠ¥" >> package/README_Windows.txt
        echo "" >> package/README_Windows.txt
        echo "- âœ… ê°œì„ ëœ CSS ì„ íƒìë¡œ ë” ì •í™•í•œ ë°ì´í„° íŒŒì‹±" >> package/README_Windows.txt
        echo "- âœ… ì¤‘ë³µ ì œê±° ë¹„í™œì„±í™” (ëª¨ë“  ë°ì´í„° ìˆ˜ì§‘)" >> package/README_Windows.txt
        echo "- âœ… TypeScript íŒŒì¼ ì°¸ê³ ë¡œ ìµœì í™”ëœ ì„ íƒì" >> package/README_Windows.txt
        echo "- âœ… ìƒì„¸ í˜ì´ì§€ ê¸°ë°˜ ì •í™•í•œ ì •ë³´ ì¶”ì¶œ" >> package/README_Windows.txt
        echo "- âœ… ì£¼ì†Œ, ë¶€ë™ì‚°, ê´€ë¦¬ë¹„, ë“±ë¡ì¼ í•„ë“œ ê°œì„ " >> package/README_Windows.txt
        echo "" >> package/README_Windows.txt
        echo "## ğŸ“¦ ì„¤ì¹˜ ë° ì‹¤í–‰" >> package/README_Windows.txt
        echo "" >> package/README_Windows.txt
        echo "1. ë‹¤ìš´ë¡œë“œí•œ í´ë”ë¥¼ ì›í•˜ëŠ” ìœ„ì¹˜ì— ì••ì¶• í•´ì œ" >> package/README_Windows.txt
        echo "2. `ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat` íŒŒì¼ì„ ë”ë¸”í´ë¦­í•˜ì—¬ ì‹¤í–‰" >> package/README_Windows.txt
        echo "3. GUI ëª¨ë“œ ë˜ëŠ” CLI ëª¨ë“œ ì„ íƒ" >> package/README_Windows.txt
        echo "" >> package/README_Windows.txt
        echo "## ğŸ–¥ï¸ GUI ëª¨ë“œ" >> package/README_Windows.txt
        echo "- ê·¸ë˜í”½ ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•œ ì‰¬ìš´ ì‚¬ìš©" >> package/README_Windows.txt
        echo "- ì§€ì—­, ë§¤ë¬¼ íƒ€ì…, ìˆ˜ëŸ‰ ë“±ì„ ë§ˆìš°ìŠ¤ë¡œ ì„¤ì •" >> package/README_Windows.txt
        echo "- ì‹¤ì‹œê°„ ì§„í–‰ ìƒí™© í™•ì¸" >> package/README_Windows.txt
        echo "- ê°œì„ ëœ ë°ì´í„° íŒŒì‹±ìœ¼ë¡œ ë” ì •í™•í•œ ì •ë³´ ìˆ˜ì§‘" >> package/README_Windows.txt
        echo "" >> package/README_Windows.txt
        echo "## ğŸ’» CLI ëª¨ë“œ" >> package/README_Windows.txt
        echo "- ëª…ë ¹ì¤„ì„ í†µí•œ ê³ ê¸‰ ì‚¬ìš©" >> package/README_Windows.txt
        echo "- ìë™í™” ë° ë°°ì¹˜ ì²˜ë¦¬ì— ì í•©" >> package/README_Windows.txt
        echo "- ì‚¬ìš©ë²•: `ë‹¤ë°©í¬ë¡¤ëŸ¬_CLI.exe --region \"ì§€ì—­ëª…\" --type \"ë§¤ë¬¼íƒ€ì…\" --limit ê°œìˆ˜`" >> package/README_Windows.txt
        echo "" >> package/README_Windows.txt
        echo "## ğŸ“‹ ì§€ì›í•˜ëŠ” ë§¤ë¬¼ íƒ€ì…" >> package/README_Windows.txt
        echo "- ì›ë£¸" >> package/README_Windows.txt
        echo "- íˆ¬ë£¸" >> package/README_Windows.txt
        echo "- ì•„íŒŒíŠ¸" >> package/README_Windows.txt
        echo "- ì£¼íƒ/ë¹Œë¼" >> package/README_Windows.txt
        echo "- ì˜¤í”¼ìŠ¤í…”" >> package/README_Windows.txt
        echo "" >> package/README_Windows.txt
        echo "## âš™ï¸ ì„¤ì • íŒŒì¼" >> package/README_Windows.txt
        echo "- `config/settings.toml`: ê¸°ë³¸ ì„¤ì • íŒŒì¼" >> package/README_Windows.txt
        echo "- í•„ìš”ì— ë”°ë¼ ìˆ˜ì • ê°€ëŠ¥" >> package/README_Windows.txt
        echo "" >> package/README_Windows.txt
        echo "## ğŸ“Š ì¶œë ¥ íŒŒì¼" >> package/README_Windows.txt
        echo "- `output/`: ìˆ˜ì§‘ëœ ë°ì´í„°ê°€ Excel íŒŒì¼ë¡œ ì €ì¥ë¨" >> package/README_Windows.txt
        echo "- `logs/`: ì‹¤í–‰ ë¡œê·¸ íŒŒì¼" >> package/README_Windows.txt
        echo "- íŒŒì¼ëª… í˜•ì‹: `dabang_ì§€ì—­ëª…_YYYYMMDD_HHMMSS.xlsx`" >> package/README_Windows.txt
        echo "" >> package/README_Windows.txt
        echo "## ğŸ”§ ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­" >> package/README_Windows.txt
        echo "- Windows 10/11 (64ë¹„íŠ¸)" >> package/README_Windows.txt
        echo "- ì¸í„°ë„· ì—°ê²° í•„ìš”" >> package/README_Windows.txt
        echo "- ìµœì†Œ 4GB RAM ê¶Œì¥" >> package/README_Windows.txt
        echo "- Python 3.10+ (ìë™ ì„¤ì¹˜ë¨)" >> package/README_Windows.txt
        echo "" >> package/README_Windows.txt
        echo "## ğŸ› ë¬¸ì œ í•´ê²°" >> package/README_Windows.txt
        echo "- ì‹¤í–‰ì´ ì•ˆ ë˜ëŠ” ê²½ìš°: Windows Defender ë˜ëŠ” ë°”ì´ëŸ¬ìŠ¤ ë°±ì‹ ì—ì„œ ì˜ˆì™¸ ì²˜ë¦¬" >> package/README_Windows.txt
        echo "- ë°ì´í„° ìˆ˜ì§‘ì´ ì•ˆ ë˜ëŠ” ê²½ìš°: ì¸í„°ë„· ì—°ê²° í™•ì¸ ë° ë‹¤ë°© ì›¹ì‚¬ì´íŠ¸ ì ‘ì† í…ŒìŠ¤íŠ¸" >> package/README_Windows.txt
        echo "- íŒŒì‹± ì˜¤ë¥˜ê°€ ìˆëŠ” ê²½ìš°: ë¡œê·¸ íŒŒì¼ í™•ì¸ í›„ ì¬ì‹œë„" >> package/README_Windows.txt
        echo "" >> package/README_Windows.txt
        echo "## ğŸ“ ë³€ê²½ì‚¬í•­" >> package/README_Windows.txt
        echo "- v2.0: TypeScript íŒŒì¼ ì°¸ê³ ë¡œ CSS ì„ íƒì ê°œì„ " >> package/README_Windows.txt
        echo "- v2.0: ìƒì„¸ í˜ì´ì§€ ê¸°ë°˜ ì •í™•í•œ ì •ë³´ ì¶”ì¶œ" >> package/README_Windows.txt
        echo "- v2.0: ì¤‘ë³µ ì œê±° ë¹„í™œì„±í™”ë¡œ ëª¨ë“  ë°ì´í„° ìˆ˜ì§‘" >> package/README_Windows.txt
        echo "- v2.0: ì£¼ì†Œ, ë¶€ë™ì‚°, ê´€ë¦¬ë¹„, ë“±ë¡ì¼ í•„ë“œ íŒŒì‹± ê°œì„ " >> package/README_Windows.txt
        echo "" >> package/README_Windows.txt
        echo "## ğŸ“„ ë¼ì´ì„ ìŠ¤" >> package/README_Windows.txt
        echo "ì´ ì†Œí”„íŠ¸ì›¨ì–´ëŠ” êµìœ¡ ë° ê°œì¸ ì‚¬ìš© ëª©ì ìœ¼ë¡œë§Œ ì‚¬ìš©í•˜ì„¸ìš”." >> package/README_Windows.txt
        echo "ìƒì—…ì  ì‚¬ìš© ì‹œ ë‹¤ë°©ì˜ ì´ìš©ì•½ê´€ì„ í™•ì¸í•˜ì„¸ìš”." >> package/README_Windows.txt
        
    - name: Create ZIP package
      run: |
        $version = $env:GITHUB_REF_NAME
        if ($version -like "refs/tags/v*") {
          $version = $version.Replace("refs/tags/v", "")
        } else {
          $version = "dev"
        }
        $zipName = "ë‹¤ë°©í¬ë¡¤ëŸ¬_Windows_v$version.zip"
        Compress-Archive -Path "package/*" -DestinationPath $zipName
        
    - name: Upload artifacts
      uses: actions/upload-artifact@v4  # v3ì—ì„œ v4ë¡œ ì—…ë°ì´íŠ¸
      with:
        name: ë‹¤ë°©í¬ë¡¤ëŸ¬-Windows-${{ matrix.python-version }}
        path: |
          *.zip
          dist/*.exe
        retention-days: 30
        
    - name: Create release (on tag)
      if: startsWith(github.ref, 'refs/tags/')
      uses: actions/create-release@v1
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      with:
        tag_name: ${{ github.ref }}
        release_name: ë‹¤ë°©í¬ë¡¤ëŸ¬ Windows v${{ github.ref_name }}
        body: "## ğŸš€ ë‹¤ë°©í¬ë¡¤ëŸ¬ Windows v${{ github.ref_name }} ë¦´ë¦¬ì¦ˆ\n\n### ğŸ“¦ ë‹¤ìš´ë¡œë“œ\n- GUI ëª¨ë“œ: `ë‹¤ë°©í¬ë¡¤ëŸ¬.exe`\n- CLI ëª¨ë“œ: `ë‹¤ë°©í¬ë¡¤ëŸ¬_CLI.exe`\n\n### âœ¨ ì£¼ìš” ê¸°ëŠ¥\n- ë‹¤ë°© ë¶€ë™ì‚° ë§¤ë¬¼ ìë™ ìˆ˜ì§‘\n- Excel íŒŒì¼ë¡œ ë°ì´í„° ì €ì¥\n- GUI ë° CLI ëª¨ë“œ ì§€ì›\n- ì§€ì—­ë³„, ë§¤ë¬¼ íƒ€ì…ë³„ í•„í„°ë§\n- **ê°œì„ ëœ CSS ì„ íƒìë¡œ ì •í™•í•œ ë°ì´í„° íŒŒì‹±**\n- **ì¤‘ë³µ ì œê±° ë¹„í™œì„±í™” (ëª¨ë“  ë°ì´í„° ìˆ˜ì§‘)**\n- **TypeScript íŒŒì¼ ì°¸ê³ ë¡œ ìµœì í™”ëœ ì„ íƒì**\n\n### ğŸ”§ ì„¤ì¹˜ ë°©ë²•\n1. ZIP íŒŒì¼ ë‹¤ìš´ë¡œë“œ ë° ì••ì¶• í•´ì œ\n2. `ë‹¤ë°©í¬ë¡¤ëŸ¬_ì‹¤í–‰.bat` ì‹¤í–‰\n3. GUI ë˜ëŠ” CLI ëª¨ë“œ ì„ íƒ\n\n### ğŸ“‹ ì§€ì›í•˜ëŠ” ë§¤ë¬¼ íƒ€ì…\n- ì›ë£¸, íˆ¬ë£¸, ì•„íŒŒíŠ¸, ì£¼íƒ/ë¹Œë¼, ì˜¤í”¼ìŠ¤í…”\n\n### ğŸ’» CLI ì‚¬ìš©ë²•\n```bash\në‹¤ë°©í¬ë¡¤ëŸ¬_CLI.exe --region \"ì„œìš¸ ê°•ë‚¨\" --type \"ì›ë£¸\" --limit 10\në‹¤ë°©í¬ë¡¤ëŸ¬_CLI.exe --region \"ë¶€ì‚° í•´ìš´ëŒ€\" --type \"ì•„íŒŒíŠ¸\" --limit 20\n```\n\n### ğŸ”§ ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­\n- Windows 10/11 (64ë¹„íŠ¸)\n- ì¸í„°ë„· ì—°ê²°\n- ìµœì†Œ 4GB RAM\n- Python 3.10+ (ìë™ ì„¤ì¹˜ë¨)\n\n### ğŸ“ ë³€ê²½ì‚¬í•­\n- v2.0: TypeScript íŒŒì¼ ì°¸ê³ ë¡œ CSS ì„ íƒì ê°œì„ \n- v2.0: ìƒì„¸ í˜ì´ì§€ ê¸°ë°˜ ì •í™•í•œ ì •ë³´ ì¶”ì¶œ\n- v2.0: ì¤‘ë³µ ì œê±° ë¹„í™œì„±í™”ë¡œ ëª¨ë“  ë°ì´í„° ìˆ˜ì§‘\n- v2.0: ì£¼ì†Œ, ë¶€ë™ì‚°, ê´€ë¦¬ë¹„, ë“±ë¡ì¼ í•„ë“œ íŒŒì‹± ê°œì„ "
        draft: false
        prerelease: false
